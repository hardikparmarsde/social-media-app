{"ast":null,"code":"import _regeneratorRuntime from\"D:/projects/social-media-app/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"D:/projects/social-media-app/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"D:/projects/social-media-app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/projects/social-media-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import{useDispatch}from\"react-redux\";import{useLocation,useNavigate}from\"react-router-dom\";import{createPost,updatePost}from\"../../../actions/actions\";import{useSelector}from\"react-redux\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var UploadPost=function UploadPost(_ref){var currentId=_ref.currentId,setCurrentId=_ref.setCurrentId,user=_ref.user;var dispatch=useDispatch();var navigateTo=useNavigate();var post=useSelector(function(state){return currentId?state.posts.posts.find(function(p){return p._id===currentId;}):null;});var _useState=useState([]),_useState2=_slicedToArray(_useState,2),tags=_useState2[0],setTags=_useState2[1];var _useState3=useState({tags:[],message:\"\",selectedFile:\"\",name:\"\"}),_useState4=_slicedToArray(_useState3,2),postData=_useState4[0],setPostData=_useState4[1];useEffect(function(){if(currentId)setPostData(post);},[]);var handleOnSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var _user$result,_user$result2;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();console.log(postData);setPostData(_objectSpread(_objectSpread({},postData),{},{tags:tags}));if(currentId)dispatch(updatePost(currentId,_objectSpread(_objectSpread({},postData),{},{name:user===null||user===void 0?void 0:(_user$result=user.result)===null||_user$result===void 0?void 0:_user$result.name})));else dispatch(createPost(_objectSpread(_objectSpread({},postData),{},{name:user===null||user===void 0?void 0:(_user$result2=user.result)===null||_user$result2===void 0?void 0:_user$result2.name})));clear();navigateTo('/feed');case 6:case\"end\":return _context.stop();}}},_callee);}));return function handleOnSubmit(_x){return _ref2.apply(this,arguments);};}();var clear=function clear(){setPostData({selectedFile:'',message:'',tags:[]});};var handleBack=function handleBack(e){e.preventDefault();navigateTo(-1);};var handleTags=function handleTags(e){setTags(e.target.value);};return/*#__PURE__*/_jsx(\"div\",{className:\"w-full sm:w-96 sm:mx-auto md:w-1/3\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"p-5 shadow-lg space-y-2\",enctype:\"multipart/form-data\",onSubmit:handleOnSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"fill-red-400\",xmlns:\"http://www.w3.org/2000/svg\",width:\"45\",height:\"45\",viewBox:\"0 0 16 16\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M8 2a5.53 5.53 0 0 0-3.594 1.342c-.766.66-1.321 1.52-1.464 2.383C1.266 6.095 0 7.555 0 9.318 0 11.366 1.708 13 3.781 13h8.906C14.502 13 16 11.57 16 9.773c0-1.636-1.242-2.969-2.834-3.194C12.923 3.999 10.69 2 8 2zm2.354 5.146a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708l2-2a.5.5 0 0 1 .708 0l2 2z\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center\",children:/*#__PURE__*/_jsxs(\"h1\",{className:\"text-gray-700 font-medium\",children:[post?'Edit':'Upload',\" a Post\"]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-1\",children:/*#__PURE__*/_jsx(\"textarea\",{className:\"w-full focus:ring-1 focus:outline-none focus:ring-red-400 rounded border border-gray-300 p-2  text-gray-800\",maxLength:100,name:\"message\",type:\"text\",value:postData.message,onChange:function onChange(e){return setPostData(_objectSpread(_objectSpread({},postData),{},{message:e.target.value}));},placeholder:\"Write something about a post here...\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full\",children:/*#__PURE__*/_jsx(\"input\",{className:\"\",type:\"file\",accept:\".jpg, .jpeg, .png\",name:\"selectedFile\",onChange:function onChange(e){return setPostData(_objectSpread(_objectSpread({},postData),{},{selectedFile:e.target.files[0]}));},required:currentId==null})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex w-full\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"w-1/2 pr-2 bg-red-400 text-white rounded-l\",children:\"Submit\"}),/*#__PURE__*/_jsx(\"button\",{type:\"reset\",className:\"w-1/2 p-3 bg-gray-300 rounded-r\",onClick:clear,children:\"Clear\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"\",children:/*#__PURE__*/_jsxs(\"button\",{className:\"p-2  justify-center font-medium  w-full rounded flex items-center\",onClick:handleBack,children:[/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"16\",height:\"16\",fill:\"currentColor\",class:\"bi bi-backspace-fill\",viewBox:\"0 0 16 16\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M15.683 3a2 2 0 0 0-2-2h-7.08a2 2 0 0 0-1.519.698L.241 7.35a1 1 0 0 0 0 1.302l4.843 5.65A2 2 0 0 0 6.603 15h7.08a2 2 0 0 0 2-2V3zM5.829 5.854a.5.5 0 1 1 .707-.708l2.147 2.147 2.146-2.147a.5.5 0 1 1 .707.708L9.39 8l2.146 2.146a.5.5 0 0 1-.707.708L8.683 8.707l-2.147 2.147a.5.5 0 0 1-.707-.708L7.976 8 5.829 5.854z\"})}),\"\\xA0 Go to Feed\"]})})]})});};export default UploadPost;","map":{"version":3,"names":["React","useEffect","useState","useDispatch","useLocation","useNavigate","createPost","updatePost","useSelector","UploadPost","currentId","setCurrentId","user","dispatch","navigateTo","post","state","posts","find","p","_id","tags","setTags","message","selectedFile","name","postData","setPostData","handleOnSubmit","e","preventDefault","console","log","result","clear","handleBack","handleTags","target","value","files"],"sources":["D:/projects/social-media-app/client/src/components/Posts/Post/UploadPost.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\"\r\nimport { useDispatch } from \"react-redux\";\r\nimport { useLocation, useNavigate } from \"react-router-dom\";\r\nimport { createPost, updatePost } from \"../../../actions/actions\";\r\nimport { useSelector } from \"react-redux\";\r\n\r\nconst UploadPost = ({ currentId, setCurrentId, user}) => {\r\n    const dispatch = useDispatch();\r\n    const navigateTo = useNavigate();\r\n        \r\n    const post = useSelector((state) => currentId ? state.posts.posts.find((p) => p._id === currentId) : null);        \r\n    \r\n    const[tags, setTags] = useState([]);\r\n    const [postData, setPostData] = useState({\r\n        tags: [], \r\n        message: \"\",\r\n        selectedFile: \"\",\r\n        name: \"\"\r\n    });\r\n    useEffect(() => {\r\n        if(currentId)\r\n            setPostData(post);\r\n    },[]);\r\n\r\n    const handleOnSubmit =  async (e) => {\r\n        e.preventDefault();\r\n\r\n        console.log(postData);\r\n\r\n        setPostData({ ...postData, tags: tags});\r\n\r\n        if(currentId) \r\n            dispatch(updatePost(currentId, { ...postData, name: user?.result?.name })); \r\n        else \r\n            dispatch(createPost({ ...postData, name:  user?.result?.name}));  \r\n\r\n        clear();\r\n        navigateTo('/feed');\r\n    }\r\n\r\n    const clear = () => {\r\n        setPostData({ selectedFile:'', message:'', tags:[] });\r\n    }\r\n\r\n    const handleBack = (e) => {\r\n        e.preventDefault();\r\n        navigateTo(-1);\r\n    }    \r\n\r\n    const handleTags = (e) => { \r\n        setTags(e.target.value);\r\n    }\r\n    \r\n    return (\r\n        <div className=\"w-full sm:w-96 sm:mx-auto md:w-1/3\">\r\n            <form className=\"p-5 shadow-lg space-y-2\" enctype=\"multipart/form-data\" onSubmit={handleOnSubmit}>\r\n                <div>\r\n                <div className=\"flex justify-center\">\r\n                    <svg className=\"fill-red-400\" xmlns=\"http://www.w3.org/2000/svg\" width=\"45\" height=\"45\" viewBox=\"0 0 16 16\">\r\n                        <path d=\"M8 2a5.53 5.53 0 0 0-3.594 1.342c-.766.66-1.321 1.52-1.464 2.383C1.266 6.095 0 7.555 0 9.318 0 11.366 1.708 13 3.781 13h8.906C14.502 13 16 11.57 16 9.773c0-1.636-1.242-2.969-2.834-3.194C12.923 3.999 10.69 2 8 2zm2.354 5.146a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708l2-2a.5.5 0 0 1 .708 0l2 2z\"/>\r\n                    </svg>\r\n                </div>\r\n                    <div className=\"flex justify-center\">\r\n                        <h1 className=\"text-gray-700 font-medium\">{post ? 'Edit': 'Upload'} a Post</h1>\r\n                    </div>\r\n                </div>\r\n                <div className=\"space-y-1\">\r\n                    <textarea className=\"w-full focus:ring-1 focus:outline-none focus:ring-red-400 rounded border border-gray-300 p-2  text-gray-800\" maxLength={100} name=\"message\" type=\"text\" value={postData.message} onChange={(e) => setPostData({ ...postData, message: e.target.value})} placeholder=\"Write something about a post here...\" />\r\n                </div>\r\n                {/* <div className=\"space-y-1\">\r\n                    <input className=\"w-full focus:ring-1 focus:outline-none focus:ring-red-400 rounded border border-gray-300 p-2 text-gray-800\" name=\"tags\" type=\"text\" value={postData.tags} onChange={handleTags} placeholder=\"Tags e.g. travel, foodie, cricket\" />\r\n                </div> */}\r\n                <div className=\"w-full\">\r\n                    <input \r\n                    className=\"\"\r\n                    type=\"file\"\r\n                    accept=\".jpg, .jpeg, .png\"\r\n                    name=\"selectedFile\"  \r\n                    onChange={(e) => setPostData({ ...postData, selectedFile: e.target.files[0] })} required={currentId == null}\r\n                    />                    \r\n                </div>\r\n                <div className=\"flex w-full\">\r\n                    <button type=\"submit\" className=\"w-1/2 pr-2 bg-red-400 text-white rounded-l\">Submit</button>\r\n                    <button type=\"reset\" className=\"w-1/2 p-3 bg-gray-300 rounded-r\" onClick={clear}>Clear</button>\r\n                </div>\r\n                <div className=\"\">\r\n                    <button className=\"p-2  justify-center font-medium  w-full rounded flex items-center\" onClick={handleBack}>\r\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-backspace-fill\" viewBox=\"0 0 16 16\">\r\n                          <path d=\"M15.683 3a2 2 0 0 0-2-2h-7.08a2 2 0 0 0-1.519.698L.241 7.35a1 1 0 0 0 0 1.302l4.843 5.65A2 2 0 0 0 6.603 15h7.08a2 2 0 0 0 2-2V3zM5.829 5.854a.5.5 0 1 1 .707-.708l2.147 2.147 2.146-2.147a.5.5 0 1 1 .707.708L9.39 8l2.146 2.146a.5.5 0 0 1-.707.708L8.683 8.707l-2.147 2.147a.5.5 0 0 1-.707-.708L7.976 8 5.829 5.854z\"/>\r\n                        </svg>            \r\n                        \t&nbsp;       \r\n                        Go to Feed\r\n                    </button>\r\n                </div>\r\n            </form>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default UploadPost;"],"mappings":"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"},"metadata":{},"sourceType":"module"}